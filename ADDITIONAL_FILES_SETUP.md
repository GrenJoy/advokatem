# üìé –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

## ‚úÖ **–ß–¢–û –î–û–ë–ê–í–õ–ï–ù–û:**

### **1. –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:**
```sql
CREATE TABLE case_additional_files (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    case_id UUID NOT NULL REFERENCES cases(id) ON DELETE CASCADE,
    file_name VARCHAR(255) NOT NULL,
    original_name VARCHAR(255) NOT NULL,
    file_type VARCHAR(100),
    file_size BIGINT,
    file_path TEXT,
    description TEXT,
    is_important BOOLEAN DEFAULT false,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);
```

### **2. API Endpoints:**
- `POST /api/optimized/additional-files/upload` - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
- `GET /api/optimized/cases/{id}/additional-files` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –¥–µ–ª–∞
- `DELETE /api/optimized/additional-files/{id}` - —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞

### **3. Frontend —Ñ—É–Ω–∫—Ü–∏–∏:**
- –ü–∞–Ω–µ–ª—å "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã" 
- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º
- –û—Ç–º–µ—Ç–∫–∞ –≤–∞–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

## üóÑÔ∏è **–ù–ê–°–¢–†–û–ô–ö–ê –ë–ê–ó–´ –î–ê–ù–ù–´–•:**

### **–®–∞–≥ 1: –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—É—é –±–∞–∑—É (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)**
–í Supabase SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```sql
DROP SCHEMA public CASCADE;
CREATE SCHEMA public;
GRANT ALL ON SCHEMA public TO postgres;
GRANT ALL ON SCHEMA public TO public;
```

### **–®–∞–≥ 2: –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –±–∞–∑—É**
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤–µ—Å—å –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ `optimized_schema.sql` –≤ Supabase SQL Editor.

### **–®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü**
```sql
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public' 
ORDER BY table_name;
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–∞–±–ª–∏—Ü—ã:
- cases
- case_photos
- photo_ocr_results
- photo_comments
- ai_chat_sessions
- ai_chat_messages
- case_context_cache
- **case_additional_files** ‚Üê –Ω–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞

## üéØ **–ö–ê–ö –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨:**

### **1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:**
1. –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–ª–æ
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–§–∞–π–ª—ã" –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ
3. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å"
4. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª (Word, PDF, Excel, —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã)
5. –î–æ–±–∞–≤—å—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
6. –û—Ç–º–µ—Ç—å—Ç–µ –∫–∞–∫ –≤–∞–∂–Ω—ã–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
7. –ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å"

### **2. –ü—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∞–π–ª–æ–≤:**
- –í—Å–µ —Ñ–∞–π–ª—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –ø–∞–Ω–µ–ª–∏ "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã"
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞–∑–≤–∞–Ω–∏–µ, –¥–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏, —Ä–∞–∑–º–µ—Ä
- –í–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–æ–º–µ—á–µ–Ω—ã –∫—Ä–∞—Å–Ω—ã–º –±–µ–π–¥–∂–µ–º
- –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª –∫–Ω–æ–ø–∫–æ–π –∫–æ—Ä–∑–∏–Ω—ã

### **3. –¢–∏–ø—ã —Ñ–∞–π–ª–æ–≤:**
- **Word –¥–æ–∫—É–º–µ–Ω—Ç—ã** (.doc, .docx)
- **PDF —Ñ–∞–π–ª—ã** (.pdf)
- **Excel —Ç–∞–±–ª–∏—Ü—ã** (.xls, .xlsx)
- **–¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã** (.txt, .rtf)

## üîß **–¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò:**

### **–•—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤:**
- –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∫–∞–∫ BLOB
- –ü—É—Ç—å: `/uploads/additional/{fileId}-{originalName}`
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 10MB (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)

### **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ:**
- `original_name` - –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞
- `file_type` - MIME —Ç–∏–ø —Ñ–∞–π–ª–∞
- `file_size` - —Ä–∞–∑–º–µ—Ä –≤ –±–∞–π—Ç–∞—Ö
- `description` - –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
- `is_important` - —Ñ–ª–∞–≥ –≤–∞–∂–Ω–æ—Å—Ç–∏

### **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- –§–∞–π–ª—ã –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –¥–µ–ª—É
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –¥–µ–ª–∞ —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ —Ñ–∞–π–ª—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ –Ω–∞ frontend

## üéâ **–ì–û–¢–û–í–û!**

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ:
- ‚úÖ –ó–∞–≥—Ä—É–∂–∞—Ç—å Word –¥–æ–∫—É–º–µ–Ω—Ç—ã, PDF, Excel —Ñ–∞–π–ª—ã
- ‚úÖ –î–æ–±–∞–≤–ª—è—Ç—å –æ–ø–∏—Å–∞–Ω–∏—è –∫ —Ñ–∞–π–ª–∞–º
- ‚úÖ –û—Ç–º–µ—á–∞—Ç—å –≤–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã
- ‚úÖ –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã –¥–µ–ª–∞
- ‚úÖ –£–¥–∞–ª—è—Ç—å –Ω–µ–Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã
- ‚úÖ –§–∞–π–ª—ã –ù–ï –∏–¥—É—Ç –≤ OCR (—Ç–æ–ª—å–∫–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏)

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ
